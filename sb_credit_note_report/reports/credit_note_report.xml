<template id="credit_note_report_template">
    <t t-call="web.html_container">
        <t t-call="web.external_layout">
            <style>
                /* تحديد حجم الصفحة A4 عمودي */
                @page {
                    size: A4 portrait;
                    margin: 1.5cm 1cm 1.5cm 1cm;
                }
                
                /* تحسين الخطوط والعناصر */
                body {
                    font-family: 'Arial', sans-serif;
                    font-size: 12px;
                    line-height: 1.4;
                }
                
                .company-name {
                    font-size: 16px;
                    font-weight: bold;
                    text-align: center;
                    margin-bottom: 10px;
                }
                
                .report-title {
                    font-size: 14px;
                    font-weight: bold;
                    text-align: center;
                    margin: 15px 0;
                }
                
                .info-section p {
                    margin: 5px 0;
                    font-size: 12px;
                }
                
                .table {
                    width: 100%;
                    margin-top: 15px;
                    font-size: 11px;
                    border-collapse: collapse;
                }
                
                .table th {
                    background-color: #f2f2f2;
                    font-weight: bold;
                    text-align: center;
                    padding: 5px;
                    border: 1px solid #ddd;
                }
                
                .table td {
                    padding: 5px;
                    border: 1px solid #ddd;
                    text-align: center;
                }
                
                /* مسافة إضافية بعد الهيدر */
                .header-space {
                    height: 30px;
                }
            </style>
            
            <div class="page" dir="rtl">
                <div class="header-space"></div>
                
                <div class="company-name">
                    <t t-esc="form['company_id'][1]"/>
                </div>
                
                <div class="report-title">ارجـاعــات المبيـــعات</div>
                
                <div class="row info-section">
                    <div class="col-auto col-3 mw-100 mb-2">
                        <p>
                            <strong>
                                <t t-if="form['branch_names'] and len(form['branch_names'].split(',')) == 1">
                                    الفــرع: <span t-esc="form['branch_names']"/>
                                </t>
                            </strong>
                        </p>
                        <p>
                            <strong>مــن تـاريـخ: <span t-esc="form['date_from']"/></strong>
                        </p>
                        <p>
                            <strong>الــي تـاريـخ: <span t-esc="form['date_to']"/></strong>
                        </p>
                        <p>
                            <strong>طبـع بواسطـة: <span t-esc="form['printed_by']"/></strong>
                        </p>
                        <p>
                            <strong>تـاريخ الطبـاعـة: <span t-esc="form['print_date']"/></strong>
                        </p>
                    </div>
                </div>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th style="width: 15%;">اسم الفرع</th>
                            <th style="width: 12%;">رقم الارجاع</th>
                            <th style="width: 18%;">اسم البائع</th>
                            <th style="width: 18%;">اسم العميل</th>
                            <th style="width: 15%;">تاريح الارجاع</th>
                            <th style="width: 12%;">اجمالى الارجاعات</th>
                            <th style="width: 10%;">تكلفة الارجاعات</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="invoice" t-as="component">
                            <tr>
                                <td>
                                    <t t-if="component['branch_id'] and isinstance(component['branch_id'], list) and len(component['branch_id']) > 1">
                                        <t t-esc="component['branch_id'][1]"/>
                                    </t>
                                </td>
                                <td><t t-esc="component['name']"/></td>
                                <td>
                                    <t t-if="component['created_by_id'] and isinstance(component['created_by_id'], list) and len(component['created_by_id']) > 1">
                                        <t t-esc="component['created_by_id'][1]"/>
                                    </t>
                                </td>
                                <td>
                                    <t t-if="component['partner_id'] and isinstance(component['partner_id'], list) and len(component['partner_id']) > 1">
                                        <span t-esc="component['partner_id'][1]"/>
                                    </t>
                                </td>
                                <td><t t-esc="component['invoice_date']"/></td>
                                <td><t t-esc="component['amount_untaxed']"/></td>
                                <td><t t-esc="component['total_purchase_price']"/></td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </div>
        </t>
    </t>
</template>
